"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[745],{745:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var s=n(528),o=n(43),r=n(3),i=n(464),c=n(321),a=n(546),l=n(501),h=n(678),d=n(104);"undefined"!==typeof window&&("leochlon.github.io"===window.location.hostname||window.location.hostname.includes("github.io"));const m=new class{constructor(){this.socket=null,this.isConnected=!1,this.eventListeners=new Map,this.connectionPromise=null}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://ai-careers-backend.fly.dev";if(console.log("Socket connecting to:",e),this.socket&&this.isConnected)return Promise.resolve(this.socket);if(this.connectionPromise)return this.connectionPromise;this.socket&&this.disconnect(),this.connectionPromise=new Promise(((t,n)=>{this.socket=(0,d.Ay)(e,{transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!0,timeout:1e4,forceNew:!0});const s=()=>{console.log("Connected to chat server"),this.isConnected=!0,this.socket.off("connect_error",o),t(this.socket)},o=e=>{console.error("Connection error:",e),this.isConnected=!1,this.socket.off("connect",s),n(e)};this.socket.once("connect",s),this.socket.once("connect_error",o),this.socket.on("disconnect",(e=>{console.log("Disconnected from chat server:",e),this.isConnected=!1,this.connectionPromise=null}))}));try{return await this.connectionPromise,this.connectionPromise=null,this.socket}catch(t){throw this.connectionPromise=null,t}}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1,this.connectionPromise=null)}joinChat(e){this.socket&&this.isConnected?(console.log("Joining chat with data:",e),this.socket.emit("join_chat",e)):console.warn("Cannot join chat: not connected")}sendMessage(e){this.socket&&this.isConnected?(console.log("Sending message:",e),this.socket.emit("send_message",{content:e})):console.warn("Cannot send message: not connected")}startTyping(){this.socket&&this.isConnected&&this.socket.emit("typing_start")}stopTyping(){this.socket&&this.isConnected&&this.socket.emit("typing_stop")}on(e,t){this.socket&&(this.socket.on(e,t),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t))}off(e,t){if(this.socket&&(this.socket.off(e,t),this.eventListeners.has(e))){const n=this.eventListeners.get(e),s=n.indexOf(t);s>-1&&n.splice(s,1)}}removeAllListeners(){this.socket&&(this.eventListeners.forEach(((e,t)=>{e.forEach((e=>this.socket.off(t,e)))})),this.eventListeners.clear())}getConnectionStatus(){var e;return this.isConnected&&(null===(e=this.socket)||void 0===e?void 0:e.connected)}};var u,g,p,f,y,x,b,k,v=n(685),w=n(954),C=n(579);const j=(0,i.Ay)(c.P.div).attrs({role:"dialog","aria-modal":!0,"aria-labelledby":"chat-title"})(u||(u=(0,s.A)(["\n  position: fixed;\n  right: ",";\n  bottom: ",";\n  width: 360px;\n  background: ",";\n  border: 1px solid ",";\n  border-radius: ",";\n  overflow: hidden;\n  box-shadow: ",";\n  backdrop-filter: blur(20px);\n  \n  @media (max-width: 768px) {\n    width: calc(100% - "," * 2);\n    right: ",";\n    bottom: ",";\n    max-height: 80vh;\n  }\n"])),(e=>e.theme.spacing.xl),(e=>e.theme.spacing.xl),(e=>e.theme.colors.secondary),(e=>e.theme.colors.glass.border),(e=>e.theme.borderRadius.xl),(e=>e.theme.shadows.lg),(e=>e.theme.spacing.xl),(e=>e.theme.spacing.lg),(e=>e.theme.spacing.lg)),A=i.Ay.div(g||(g=(0,s.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ",";\n  background: ",";\n  border-bottom: 1px solid ",";\n  \n  h2 {\n    color: ",";\n    font-size: ",";\n    font-weight: ",";\n  }\n"])),(e=>e.theme.spacing.lg),(e=>e.theme.colors.tertiary),(e=>e.theme.colors.glass.border),(e=>e.theme.colors.text.primary),(e=>e.theme.typography.fontSize.xl),(e=>e.theme.typography.fontWeight.semibold)),S=(0,i.Ay)(c.P.button)(p||(p=(0,s.A)(["\n  background: none;\n  border: none;\n  color: ",";\n  cursor: pointer;\n  padding: ",";\n  \n  &:hover {\n    color: ",";\n  }\n"])),(e=>e.theme.colors.text.secondary),(e=>e.theme.spacing.xs),(e=>e.theme.colors.text.primary)),N=i.Ay.div(f||(f=(0,s.A)(["\n  padding: ",";\n  max-height: 400px;\n  \n  @media (max-width: 768px) {\n    max-height: calc(80vh - 120px); // Account for header and input\n  }\n  overflow-y: auto;\n  \n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n  \n  &::-webkit-scrollbar-track {\n    background: ",";\n  }\n  \n  &::-webkit-scrollbar-thumb {\n    background: ",";\n    border-radius: ",";\n  }\n"])),(e=>e.theme.spacing.lg),(e=>e.theme.colors.glass.primary),(e=>e.theme.colors.glass.border),(e=>e.theme.borderRadius.full)),P=i.Ay.article(y||(y=(0,s.A)(["\n  display: flex;\n  gap: ",";\n  margin-bottom: ",";\n  \n  .avatar {\n    width: 32px;\n    height: 32px;\n    border-radius: ",";\n    background: ",";\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  .content {\n    flex: 1;\n    background: ",";\n    padding: ",";\n    border-radius: ",";\n    color: ",";\n  }\n  \n  &.sent {\n    flex-direction: row-reverse;\n    \n    .content {\n      background: ",";\n      color: ",";\n    }\n  }\n"])),(e=>e.theme.spacing.md),(e=>e.theme.spacing.md),(e=>e.theme.borderRadius.full),(e=>e.theme.colors.glass.secondary),(e=>e.theme.colors.glass.secondary),(e=>e.theme.spacing.md),(e=>e.theme.borderRadius.lg),(e=>e.theme.colors.text.primary),(e=>e.theme.colors.accent),(e=>e.theme.colors.primary)),T=i.Ay.input.attrs({"aria-label":"Type your message"})(x||(x=(0,s.A)(["\n  width: 100%;\n  background: ",";\n  border: 1px solid ",";\n  border-radius: ",";\n  padding: ",";\n  color: ",";\n  margin-top: ",";\n  \n  &:focus {\n    outline: none;\n    border-color: ",";\n    box-shadow: ",";\n  }\n  \n  &::placeholder {\n    color: ",";\n  }\n"])),(e=>e.theme.colors.tertiary),(e=>e.theme.colors.glass.border),(e=>e.theme.borderRadius.lg),(e=>e.theme.spacing.md),(e=>e.theme.colors.text.primary),(e=>e.theme.spacing.lg),(e=>e.theme.colors.text.accent),(e=>e.theme.shadows.accent),(e=>e.theme.colors.text.secondary)),_=i.Ay.div(b||(b=(0,s.A)(["\n  display: flex;\n  align-items: center;\n  gap: ",";\n  font-size: ",";\n  color: ",";\n  margin-left: ",";\n"])),(e=>e.theme.spacing.xs),(e=>e.theme.typography.fontSize.sm),(e=>e.theme.colors.text.secondary),(e=>e.theme.spacing.md)),L=i.Ay.div(k||(k=(0,s.A)(["\n  width: 8px;\n  height: 8px;\n  background: ",";\n  border-radius: 50%;\n"])),(e=>e.$connected?e.theme.colors.success:e.theme.colors.error)),U={hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:30}},exit:{opacity:0,y:20,scale:.95}},z=(0,o.memo)((e=>{let{message:t,userName:n}=e;return(0,C.jsxs)(P,{className:t.isUser?"sent":"","aria-label":"".concat(t.isUser?n||"You":"AI Assistant"," said: ").concat(t.text),children:[(0,C.jsx)("div",{className:"avatar",children:t.isUser?t.userGender?(0,C.jsx)("img",{src:"female"===t.userGender?w:v,alt:"".concat(t.userGender," trainer sprite"),style:{width:"24px",height:"24px",imageRendering:"pixelated"}}):"\ud83d\udc64":"\ud83e\udd16"}),(0,C.jsxs)("div",{className:"content",children:[t.isUser&&n&&(0,C.jsx)("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)",marginBottom:"0.25rem",fontWeight:"bold"},children:n}),t.text]})]})}));z.displayName="Message";const D=e=>{let{isOpen:t,onClose:n}=e;const s=(0,o.useRef)(null);(0,l.r)(s,t);const{user:i}=(0,h.Jd)(),[c,d]=(0,o.useState)([]),[u,g]=(0,o.useState)(""),[p,f]=(0,o.useState)(0),[y,x]=(0,o.useState)(!1),[b,k]=(0,o.useState)(!1),[v,w]=(0,o.useState)(new Set),[P,D]=(0,o.useState)(null),G=(0,o.useRef)(null),M=(0,o.useRef)(null);(0,o.useEffect)((()=>{if(!t||!i.hasProfile)return;let e=!0;return(async()=>{try{if(await m.connect(),!e)return;const t=t=>{e&&d(t.map((e=>({id:e._id||e.id,text:e.content,isUser:e.userName===i.name,userName:e.userName,userGender:e.userGender,timestamp:new Date(e.timestamp)}))))},n=t=>{e&&d((e=>[...e,{id:t.id,text:t.content,isUser:t.userName===i.name,userName:t.userName,userGender:t.userGender,timestamp:new Date(t.timestamp)}]))},s=t=>{e&&f(t)},o=t=>{e&&d((e=>[...e,{id:"join-".concat(Date.now(),"-").concat(Math.random()),text:"".concat(t.userName," joined the chat"),isUser:!1,isSystemMessage:!0,timestamp:new Date(t.timestamp)}]))},r=t=>{e&&d((e=>[...e,{id:"leave-".concat(Date.now(),"-").concat(Math.random()),text:"".concat(t.userName," left the chat"),isUser:!1,isSystemMessage:!0,timestamp:new Date(t.timestamp)}]))},c=t=>{e&&t.userName!==i.name&&(t.isTyping?w((e=>new Set([...e,t.userName]))):w((e=>{const n=new Set(e);return n.delete(t.userName),n})))},a=()=>{e&&(console.log("Connected to chat server"),x(!0),D(null),m.joinChat({userName:i.name,userGender:i.gender,room:"general"}))},l=()=>{e&&(console.log("Disconnected from chat server"),x(!1))},h=t=>{e&&(console.error("Connection error:",t),D("Failed to connect to chat server"),x(!1))},u=e=>{console.error("Chat error:",e),"User not found"===e.message&&m.joinChat({userName:i.name,userGender:i.gender,room:"general"})};m.on("connect",a),m.on("disconnect",l),m.on("connect_error",h),m.on("recent_messages",t),m.on("new_message",n),m.on("user_count_update",s),m.on("user_joined",o),m.on("user_left",r),m.on("user_typing",c),m.on("error",u),m.getConnectionStatus()&&a()}catch(t){console.error("Failed to setup chat:",t),e&&D("Failed to initialize chat")}})(),d([{id:"welcome",text:"Welcome to the AI Careers chat, ".concat(i.name,"! Connect with other attendees and discuss AI career opportunities."),isUser:!1,isSystemMessage:!0,timestamp:new Date}]),()=>{e=!1,M.current&&clearTimeout(M.current)}}),[t,i.hasProfile,i.name,i.gender]),(0,o.useEffect)((()=>{t||(m.removeAllListeners(),m.disconnect(),d([]),x(!1),f(0),w(new Set),D(null))}),[t]);const R=(0,o.useCallback)((()=>{var e;null===(e=G.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[]);(0,o.useEffect)((()=>{R()}),[c,R]);const E=(0,o.useCallback)((()=>{""!==u.trim()&&y&&(m.sendMessage(u.trim()),g(""),m.stopTyping(),M.current&&clearTimeout(M.current))}),[u,y]),I=(0,o.useCallback)((e=>{g(e.target.value),y&&e.target.value.length>0?(b||(k(!0),m.startTyping()),M.current&&clearTimeout(M.current),M.current=setTimeout((()=>{k(!1),m.stopTyping()}),1e3)):b&&(k(!1),m.stopTyping(),M.current&&clearTimeout(M.current))}),[y,b]),B=(0,o.useCallback)((e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())}),[E]);return t?(0,C.jsx)(r.A,{children:(0,C.jsxs)(j,{ref:s,variants:U,initial:"hidden",animate:"visible",exit:"exit",children:[(0,C.jsxs)(A,{children:[(0,C.jsxs)("h2",{id:"chat-title",children:["\ud83d\udcac ",y?"Live Chat":"Chat (Connecting...)",(0,C.jsxs)(_,{children:[(0,C.jsx)(L,{$connected:y}),y?"".concat(p," online"):"Connecting..."]})]}),(0,C.jsx)(S,{onClick:n,whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Close chat",children:"\xd7"})]}),(0,C.jsxs)(N,{role:"log","aria-live":"polite","aria-label":"Chat messages",children:[(0,C.jsx)(a.N,{children:c.map((e=>(0,C.jsx)(z,{message:e,userName:e.userName},e.id)))}),(0,C.jsx)("div",{ref:G})]}),(0,C.jsxs)("div",{style:{padding:"1rem"},children:[v.size>0&&(0,C.jsxs)("div",{style:{fontSize:"0.75rem",color:"#666",marginBottom:"0.5rem",fontStyle:"italic"},children:[Array.from(v).join(", ")," ",1===v.size?"is":"are"," typing..."]}),P&&(0,C.jsx)("div",{style:{fontSize:"0.75rem",color:"#ff6b6b",marginBottom:"0.5rem"},children:P}),(0,C.jsx)(T,{value:u,onChange:I,onKeyPress:B,placeholder:y?"Type your message...":"Connecting to chat...",disabled:!y})]})]})}):null}}}]);
//# sourceMappingURL=745.d287c81f.chunk.js.map